<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Чат</title>
</head>
<body>
    <h1>Мой гениальный код</h1>
    <input id="message" type="text" placeholder="Введите сообщение" />
    <button id="send">Отправить</button>
    <ul id="messages"></ul>

    <script>
        // Подключение к WebSocket-серверу
        const ws = new WebSocket('ws://localhost:8080');

        ws.onmessage = (event) => {
            const messagesList = document.getElementById('messages');
            const li = document.createElement('li');
            li.textContent = event.data;
            messagesList.appendChild(li);
        };

        document.getElementById('send').onclick = () => {
            const messageInput = document.getElementById('message');
            const message = messageInput.value;
            ws.send(message);
            messageInput.value = '';
        };
    </script>

    <script>
        // Серверный код (не будет работать в браузере)
        // Запустите этот код отдельно в Node.js в файле server.js

        /*
        const WebSocket = require('ws');
        const http = require('http');
        const fs = require('fs');
        const path = require('path');

        const server = http.createServer((req, res) => {
            if (req.url === '/') {
                fs.readFile(path.join(__dirname, 'index.html'), (err, data) => {
                    if (err) {
                        res.writeHead(500);
                        return res.end('Ошибка загрузки файла');
                    }
                    res.writeHead(200, { 'Content-Type': 'text/html' });
                    res.end(data);
                });
            } else {
                const filePath = path.join(__dirname, req.url);
                const extname = path.extname(filePath);
                let contentType = 'text/html';
                
                switch (extname) {
                    case '.js':
                        contentType = 'text/javascript';
                        break;
                    case '.css':
                        contentType = 'text/css';
                        break;
                }

                fs.readFile(filePath, (err, data) => {
                    if (err) {
                        res.writeHead(404);
                        res.end();
                    } else {
                        res.writeHead(200, { 'Content-Type': contentType });
                        res.end(data);
                    }
                });
            }
        });

        const wss = new WebSocket.Server({ server });

        wss.on('connection', (ws) => {
            console.log('Новое подключение');

            ws.on('message', (message) => {
                console.log('Получено сообщение: %s', message);
                wss.clients.forEach((client) => {
                    if (client.readyState === WebSocket.OPEN) {
                        client.send(message);
                    }
                });
            });

            ws.on('close', () => {
                console.log('Клиент отключился');
            });
        });

        server.listen(8080, () => {
            console.log('Сервер запущен на http://localhost:8080');
        });
        */
    </script>
</body>
</html>
